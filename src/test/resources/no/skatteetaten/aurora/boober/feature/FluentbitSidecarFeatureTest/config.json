{
  "apiVersion": "v1",
  "kind": "ConfigMap",
  "metadata": {
    "name": "simple-fluent-config",
    "namespace": "paas-utv"
  },
  "data": {
    "fluent-bit.conf" : "[SERVICE]\n   Flush        1\n   Daemon       Off\n   Log_Level    info\n   Log_File     /u01/logs/fluentbit\n   Parsers_File /fluent-bit/parser/parsers.conf\n\n[INPUT]\n   Name            tail\n   Path            /u01/logs/*.audit.text\n   Path_Key        source\n   Exclude_Path    *.[1-9].audit.text\n   Read_From_Head  true\n   Tag             audit_text\n   DB              /u01/logs/audit_text.db\n   Buffer_Max_Size 512k\n   Skip_Long_Lines On\n   Mem_Buf_Limit   20MB\n   Rotate_Wait     10\n   Key             event\n\n[INPUT]\n   Name            tail\n   Path            /u01/logs/*.audit.json\n   Path_Key        source\n   Exclude_Path    *.[1-9].audit.json\n   Read_From_Head  true\n   Tag             audit_json\n   DB              /u01/logs/audit_json.db\n   Buffer_Max_Size 512k\n   Skip_Long_Lines On\n   Mem_Buf_Limit   20MB\n   Rotate_Wait     10\n   Key             event\n\n[INPUT]\n   Name            tail\n   Path            /u01/logs/*.sensitive\n   Path_Key        source\n   Exclude_Path    *.[1-9].sensitive\n   Read_From_Head  true\n   Tag             sensitive\n   DB              /u01/logs/sensitive.db\n   Buffer_Max_Size 512k\n   Skip_Long_Lines On\n   Mem_Buf_Limit   20MB\n   Rotate_Wait     10\n   Key             event\n\n[INPUT]\n   Name            tail\n   Path            /u01/logs/*.log\n   Path_Key        source\n   Exclude_Path    *.[1-9].log\n   Read_From_Head  true\n   Tag             application\n   DB              /u01/logs/application.db\n   Buffer_Max_Size 512k\n   Skip_Long_Lines On\n   Mem_Buf_Limit   20MB\n   Rotate_Wait     10\n   Key             event\n\n[INPUT]\n   Name            tail\n   Path            /u01/logs/*.access\n   Path_Key        source\n   Exclude_Path    *.[1-9].access\n   Read_From_Head  true\n   Tag             access\n   DB              /u01/logs/access.db\n   Buffer_Max_Size 512k\n   Skip_Long_Lines On\n   Mem_Buf_Limit   20MB\n   Rotate_Wait     10\n   Key             event\n\n[INPUT]\n   Name             tail\n   Path             /u01/logs/fluentbit\n   Path_Key         source\n   Tag              fluentbit\n   Refresh_Interval 5\n   Read_from_Head   true\n   Key              event\n\n[FILTER]\n   Name             stdout\n   Match            fluentbit\n\n[FILTER]\n   Name parser\n   Match application\n   Key_Name event\n   Parser timeParser\n   Preserve_Key On\n   Reserve_Data On\n\n[FILTER]\n   name multiline\n   match application\n   multiline.key_content event\n   multiline.parser multiline-log4j\n\n[FILTER]\n   Name  modify\n   Match *\n   Add   host ${POD_NAME}\n   Add   environment ${POD_NAMESPACE}\n   Add   nodetype openshift\n   Add   name simple\n   Add   cluster utv\n\n[OUTPUT]\n   Name             splunk\n   Match            audit_text \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      aud-index\n   event_sourcetype log4j\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event\n\n[OUTPUT]\n   Name             splunk\n   Match            audit_json \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      aud-index\n   event_sourcetype _json\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event\n\n[OUTPUT]\n   Name             splunk\n   Match            sensitive \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      sensitive-index\n   event_sourcetype log4j\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event\n\n[OUTPUT]\n   Name             splunk\n   Match            application \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      test-index\n   event_sourcetype log4j\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event\n\n[OUTPUT]\n   Name             splunk\n   Match            access \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      test-index\n   event_sourcetype access_combined\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event\n\n[OUTPUT]\n   Name             splunk\n   Match            fluentbit \n   Host             ${SPLUNK_HOST}\n   Port             ${SPLUNK_PORT}\n   Splunk_token     ${HEC_TOKEN}\n   TLS              On\n   TLS.Verify       Off\n   event_index      test-index\n   event_sourcetype fluentbit\n   event_host       ${POD_NAME}\n   event_source     $source\n   event_field      application $name\n   event_field      cluster $cluster\n   event_field      environment $environment\n   event_field      nodetype $nodetype\n   event_key        $event"
  }
}