{
  "apiVersion": "v1",
  "kind": "ConfigMap",
  "metadata": {
    "name": "simple-fluent-config",
    "namespace": "paas-utv"
  },
  "data": {
    "fluent-bit.conf": "[SERVICE]\n    Flush        1\n    Daemon       Off\n    Log_Level    info\n    Parsers_File /fluent-bit/parser/parsers.conf\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.audit.json\n    Path_Key source\n    Exclude_Path *.[1-9].audit.json\n    Tag    audit_text\n    DB     /u01/logs/audit_text.db\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    Multiline    On\n    Parser_Firstline   log4jMultilineParser\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.audit.text\n    Path_Key source\n    Exclude_Path *.[1-9].audit.text\n    Tag    audit_json\n    DB     /u01/logs/audit_json.db\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    \n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.sensitive\n    Path_Key source\n    Exclude_Path *.[1-9].sensitive\n    Tag    sensitive\n    DB     /u01/logs/sensitive.db\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    Multiline    On\n    Parser_Firstline   log4jMultilineParser\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.log\n    Path_Key source\n    Exclude_Path *.[1-9].log\n    Tag    application\n    DB     /u01/logs/application.db\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    Multiline    On\n    Parser_Firstline   log4jMultilineParser\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.access\n    Path_Key source\n    Exclude_Path *.[1-9].access\n    Tag    access\n    DB     /u01/logs/access.db\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    \n\n[FILTER]\n    Name modify\n    Match audit_text\n    Set sourcetype log4j\n    Set index aud-index\n\n[FILTER]\n    Name modify\n    Match audit_json\n    Set sourcetype _json\n    Set index aud-index\n\n[FILTER]\n    Name modify\n    Match sensitive\n    Set sourcetype log4j\n    Set index sensitive-index\n\n[FILTER]\n    Name modify\n    Match application\n    Set sourcetype log4j\n    Set index test-index\n\n[FILTER]\n    Name modify\n    Match access\n    Set sourcetype access_combined\n    Set index test-index\n\n[FILTER]\n    Name modify\n    Match *\n    Add host ${POD_NAME}\n    Add environment ${POD_NAMESPACE}\n    Add nodetype openshift\n    Add application simple\n    Add cluster utv\n\n[FILTER]\n    Name nest\n    Match *\n    Operation nest\n    Wildcard environment\n    Wildcard application\n    Wildcard cluster\n    Wildcard nodetype\n    Nest_under fields\n\n[OUTPUT]\n    Name splunk\n    Match *\n    Host ${SPLUNK_HOST}\n    Port ${SPLUNK_PORT}\n    Splunk_Token ${HEC_TOKEN}\n    Splunk_Send_Raw On\n    TLS         On\n    TLS.Verify  Off\n    "
  }
}