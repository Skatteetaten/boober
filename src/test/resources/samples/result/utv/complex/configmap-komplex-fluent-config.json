{
  "apiVersion": "v1",
  "kind": "ConfigMap",
  "metadata": {
    "labels": {
      "operationScope": "aos-4016",
      "app": "komplex",
      "updatedBy": "hero",
      "updatedAt": "0",
      "lastUpdatedYear": "1970",
      "affiliation": "paas",
      "name": "komplex",
      "booberDeployId": "deploy1"
    },
    "name": "komplex-fluent-config",
    "namespace": "paas-utv",
    "ownerReferences": [
      {
        "apiVersion": "skatteetaten.no/v1",
        "kind": "ApplicationDeployment",
        "name": "komplex",
        "uid": "123-123"
      }
    ]
  },
  "data": {
    "fluent-bit.conf" : "[SERVICE]\n    Flush        1\n    Daemon       Off\n    Log_Level    info\n    Log_File     /var/log/fluentbit.log\n    Parsers_File /fluent-bit/parser/parsers.conf\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.log\n    Path_Key source\n    Exclude_Path *.[1-9].log\n    Tag    application\n    DB     /u01/logs/application.db\n    Buffer_Max_Size 512k\n    Skip_Long_Lines On\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    Multiline    On\n    Parser_Firstline   log4jMultilineParser\n\n[INPUT]\n    Name   tail\n    Path   /u01/logs/*.access\n    Path_Key source\n    Exclude_Path *.[1-9].access\n    Tag    access\n    DB     /u01/logs/access.db\n    Buffer_Max_Size 512k\n    Skip_Long_Lines On\n    Mem_Buf_Limit 20MB\n    Rotate_Wait 10\n    Key    event\n    \n\n[INPUT]\n    Name    tail\n    Path    /var/log/fluentbit.log\n    Tag     fluentbit\n    Refresh_Interval 5\n    Read_from_Head true\n    Key     event\n\n[FILTER]\n    Name modify\n    Match application\n    Set sourcetype log4j\n    Set index test-index\n\n[FILTER]\n    Name modify\n    Match access\n    Set sourcetype access_combined\n    Set index test-index\n\n[FILTER]\n    Name stdout\n    Match fluentbit\n    \n[FILTER]\n    Name modify\n    Match fluentbit\n    Set sourcetype fluentbit\n    Set index test-index\n\n[FILTER]\n    Name modify\n    Match *\n    Add host ${POD_NAME}\n    Add environment ${POD_NAMESPACE}\n    Add nodetype openshift\n    Add application komplex\n    Add cluster utv\n\n[FILTER]\n    Name nest\n    Match *\n    Operation nest\n    Wildcard environment\n    Wildcard application\n    Wildcard cluster\n    Wildcard nodetype\n    Nest_under fields\n\n[OUTPUT]\n    Name splunk\n    Match *\n    Host ${SPLUNK_HOST}\n    Port ${SPLUNK_PORT}\n    Splunk_Token ${HEC_TOKEN}\n    Splunk_Send_Raw On\n    TLS         On\n    TLS.Verify  Off\n    "
  }
}